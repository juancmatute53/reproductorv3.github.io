<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1">

<head>
    <title>Mini Reproductor v3</title>
    <link rel="stylesheet" href="main.css">
    <script src="main.js" defer></script>
</head>

<body>

    <div class="player">

        <div class="player__header">

            <div class="player__img player__img--absolute slider">

                <button class="player__button player__button--absolute--nw playlist">

                    <img src="http://physical-authority.surge.sh/imgs/icon/playlist.svg" alt="playlist-icon">

                </button>

                <button class="player__button player__button--absolute--center play">

                    <img src="http://physical-authority.surge.sh/imgs/icon/play.svg" alt="play-icon">
                    <img src="http://physical-authority.surge.sh/imgs/icon/pause.svg" alt="pause-icon">

                </button>

                <!--Imagenes para las portadas-->
                <div class="slider__content">

                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/3037271.jpg" alt="cover">
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/3037271.jpg" alt="cover">
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/quevedo.png" alt="cover">


                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/tito.jpg" alt="cover">
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                        alt="cover">

                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                        alt="cover">
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                        alt="cover">
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                        alt="cover">
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                        alt="cover">
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                        alt="cover">
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                        alt="cover">

                    <!--bad 2-->

                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/bad2.jpg" alt="cover">
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/bad2.jpg" alt="cover">
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/bad2.jpg" alt="cover">

                    <!--plan b-->
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/Plan_B_2017.jpg"
                        alt="cover">

                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/bad2.jpg" alt="cover">
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/bad2.jpg" alt="cover">

                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/remix.jpg" alt="cover">
                    <img class="img slider__img" src="https://storage.googleapis.com/hello_api/quemona.jpg" alt="cover">



                </div>

            </div>

            <div class="player__controls">

                <button class="player__button back">

                    <img class="img" src="http://physical-authority.surge.sh/imgs/icon/back.svg" alt="back-icon">

                </button>

                <p class="player__context slider__context">

                    <strong class="slider__name"></strong>
                    <span class="player__title slider__title"></span>

                </p>

                <button class="player__button next">

                    <img class="img" src="http://physical-authority.surge.sh/imgs/icon/next.svg" alt="next-icon">

                </button>

                <div class="progres">

                    <div class="progres__filled"></div>

                </div>

            </div>

        </div>

        <!--Musicas subida-->
        <ul class="player__playlist list">

            <!--Canciones-->
            <li class="player__song">

                <img class="player__img img" src="https://storage.googleapis.com/hello_api/3037271.jpg" alt="cover">

                <p class="player__context">

                    <b class="player__song-name">The Weeknd</b>
                    <span class="flex">

                        <span class="player__title">Save Your Tears</span>
                        <span class="player__song-time"></span>

                    </span>

                </p>

                <audio class="audio" src="https://storage.googleapis.com/hello_api/save%20your.mp3"></audio>

            </li>

            <li class="player__song">
                <img class="player__img img" src="https://storage.googleapis.com/hello_api/3037271.jpg" alt="cover">
                <p class="player__context">
                    <b class="player__song-name">The Weeknd</b>
                    <span class="flex">
                        <span class="player__title">Blinding Lights</span>
                        <span class="player__song-time"></span>
                    </span>
                </p>
                <audio class="audio"
                    src="https://storage.googleapis.com/hello_api/the-weeknd-blinding-lights-official-audio.mp3"></audio>
            </li>

            <li class="player__song">
                <img class="player__img img" src="https://storage.googleapis.com/hello_api/quevedo.png" alt="cover">
                <p class="player__context">
                    <b class="player__song-name">Quevedo</b>
                    <span class="flex">
                        <span class="player__title">BZRP Music Sessions #52</span>
                        <span class="player__song-time"></span>
                    </span>
                </p>
                <audio class="audio"
                    src="https://storage.googleapis.com/hello_api/quevedo-bzrp-music-sessions-vol-52.mp3"></audio>
            </li>

            <li class="player__song">

                <img class="player__img img" src="https://storage.googleapis.com/hello_api/tito.jpg" alt="cover">

                <p class="player__context">

                    <b class="player__song-name">Tito "EL Bambino"</b>
                    <span class="flex">

                        <span class="player__title">Flow Natural (Remix)</span>
                        <span class="player__song-time"></span>

                    </span>

                </p>

                <audio class="audio"
                    src="https://storage.googleapis.com/hello_api/flow-natural-remix-tito-el-bambino-ft-don-omar-beenie-man-deevani.mp3"></audio>

            </li>



            <li class="player__song">

                <img class="player__img img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                    alt="cover">

                <p class="player__context">

                    <b class="player__song-name">Bad Bunny</b>
                    <span class="flex">

                        <span class="player__title">Ojitos Lindos</span>
                        <span class="player__song-time"></span>

                    </span>

                </p>

                <audio class="audio" src="https://storage.googleapis.com/hello_api/ojitos.mp3"></audio>

            </li>


            <li class="player__song">

                <img class="player__img img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                    alt="cover">

                <p class="player__context">

                    <b class="player__song-name">Bad Bunny</b>
                    <span class="flex">

                        <span class="player__title">Me Porto Bonito</span>
                        <span class="player__song-time"></span>

                    </span>

                </p>

                <audio class="audio"
                    src="https://storage.googleapis.com/hello_api/bad-bunny-me-porto-bonito-letra-lyrics.mp3"></audio>

            </li>

            <li class="player__song">

                <img class="player__img img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                    alt="cover">

                <p class="player__context">

                    <b class="player__song-name">Bad Bunny</b>
                    <span class="flex">

                        <span class="player__title">Tití Me Preguntó</span>
                        <span class="player__song-time"></span>

                    </span>

                </p>

                <audio class="audio" src="https://storage.googleapis.com/hello_api/titi-me-pregunto.mp3"></audio>

            </li>



            <li class="player__song">

                <img class="player__img img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                    alt="cover">

                <p class="player__context">

                    <b class="player__song-name">Bad Bunny, Jhay Cortez</b>
                    <span class="flex">

                        <span class="player__title">Tarot</span>
                        <span class="player__song-time"></span>

                    </span>

                </p>

                <audio class="audio"
                    src="https://storage.googleapis.com/hello_api/bad-bunny-ft-jhay-cortez-tarot-360-visualizer-un-verano-sin-ti.mp3"></audio>

            </li>

            <li class="player__song">

                <img class="player__img img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                    alt="cover">

                <p class="player__context">

                    <b class="player__song-name">Bad Bunny</b>
                    <span class="flex">

                        <span class="player__title">Efecto</span>
                        <span class="player__song-time"></span>

                    </span>

                </p>

                <audio class="audio" src="https://storage.googleapis.com/hello_api/efecto.mp3"></audio>

            </li>


            <li class="player__song">
                <img class="player__img img" src="https://storage.googleapis.com/hello_api/un-verano-sin-ti.jpg"
                    alt="cover">
                <p class="player__context">
                    <b class="player__song-name">Bad Bunny</b>
                    <span class="flex">
                        <span class="player__title">Otro Atardecer</span>
                        <span class="player__song-time"></span>
                    </span>
                </p>
                <audio class="audio" src="https://storage.googleapis.com/hello_api/otro.mp3"></audio>
            </li>

            <li class="player__song">
                <img class="player__img img" src="https://storage.googleapis.com/hello_api/quevedo.png" alt="cover">
                <p class="player__context">
                    <b class="player__song-name">Bad Bunny</b>
                    <span class="flex">
                        <span class="player__title">Un Verano Sin Ti</span>
                        <span class="player__song-time"></span>
                    </span>
                </p>
                <audio class="audio"
                    src="https://storage.googleapis.com/hello_api/bad-bunny-un-verano-sin-ti-360-visualizer-un-verano-sin-ti.mp3"></audio>
            </li>

            <li class="player__song">
                <img class="player__img img" src="https://storage.googleapis.com/hello_api/bad2.jpg" alt="cover">
                <p class="player__context">
                    <b class="player__song-name">Bad Bunny</b>
                    <span class="flex">
                        <span class="player__title">Una Vez</span>
                        <span class="player__song-time"></span>
                    </span>
                </p>
                <audio class="audio"
                    src="https://storage.googleapis.com/hello_api/bad-bunny-x-mora-una-vez-yhlqmdlg-visualizer.mp3"></audio>
            </li>

            <li class="player__song">
                <img class="player__img img" src="https://storage.googleapis.com/hello_api/bad2.jpg" alt="cover">
                <p class="player__context">
                    <b class="player__song-name">Bad Bunny</b>
                    <span class="flex">
                        <span class="player__title">Que Malo</span>
                        <span class="player__song-time"></span>
                    </span>
                </p>
                <audio class="audio"
                    src="https://storage.googleapis.com/hello_api/bad-bunny-x-nengo-flow-que-malo-yhlqmdlg-vizualizer.mp3"></audio>
            </li>

            <li class="player__song">
                <img class="player__img img" src="https://storage.googleapis.com/hello_api/bad2.jpg" alt="cover">
                <p class="player__context">
                    <b class="player__song-name">Bad Bunny</b>
                    <span class="flex">
                        <span class="player__title">Yonaguni</span>
                        <span class="player__song-time"></span>
                    </span>
                </p>
                <audio class="audio"
                    src="https://storage.googleapis.com/hello_api/bad-bunny-yonaguni-letralyrics.mp3"></audio>
            </li>

            <li class="player__song">
                <img class="player__img img" src="https://storage.googleapis.com/hello_api/Plan_B_2017.jpg" alt="cover">
                <p class="player__context">
                    <b class="player__song-name">Plan B</b>
                    <span class="flex">
                        <span class="player__title">Es Un Secreto</span>
                        <span class="player__song-time"></span>
                    </span>
                </p>
                <audio class="audio"
                    src="https://storage.googleapis.com/hello_api/es-un-secreto-plan-b-letra.mp3"></audio>
            </li>

            <li class="player__song">
                <img class="player__img img" src="https://storage.googleapis.com/hello_api/bad2.jpg" alt="cover">
                <p class="player__context">
                    <b class="player__song-name">Bad Bunny</b>
                    <span class="flex">
                        <span class="player__title">Ignorantes</span>
                        <span class="player__song-time"></span>
                    </span>
                </p>
                <audio class="audio"
                    src="https://storage.googleapis.com/hello_api/ignorantes-bad-bunny-sech-lyricsletra.mp3"></audio>

            </li>

            <li class="player__song">
                <img class="player__img img" src="https://storage.googleapis.com/hello_api/bad2.jpg" alt="cover">
                <p class="player__context">
                    <b class="player__song-name">Bad Bunny</b>
                    <span class="flex">
                        <span class="player__title">La Santa</span>
                        <span class="player__song-time"></span>
                    </span>
                </p>
                <audio class="audio" src="https://storage.googleapis.com/hello_api/la-santa.mp3"></audio>
            </li>

            <li class="player__song">
                <img class="player__img img" src="https://storage.googleapis.com/hello_api/remix.jpg" alt="cover">
                <p class="player__context">
                    <b class="player__song-name">Nicky Jam</b>
                    <span class="flex">
                        <span class="player__title">Travesuras</span>
                        <span class="player__song-time"></span>
                    </span>
                </p>
                <audio class="audio"
                    src="https://storage.googleapis.com/hello_api/travesuras-remix-nicky-jam-ft-de-la-ghetto-j-balvin-zion-y-arcangel-video-lyric.mp3"></audio>
            </li>

            <li class="player__song">
                <img class="player__img img" src="https://storage.googleapis.com/hello_api/quemona.jpg" alt="cover">
                <p class="player__context">
                    <b class="player__song-name">Master Boys</b>
                    <span class="flex">
                        <span class="player__title">La Quemona</span>
                        <span class="player__song-time"></span>
                    </span>
                </p>
                <audio class="audio" src="https://storage.googleapis.com/hello_api/la-quemona-master-boys.mp3"></audio>
            </li>

            <!--fin-->
        </ul>

    </div>

</body>
<script>

    "use strict";

    // add elemnts
    const bgBody = ["#e5e7e9", "#ff4545", "#f8ded3", "#ffc382", "#f5eda6", "#ffcbdc", "#dcf3f3"];
    const body = document.body;
    const player = document.querySelector(".player");
    const playerHeader = player.querySelector(".player__header");
    const playerControls = player.querySelector(".player__controls");
    const playerPlayList = player.querySelectorAll(".player__song");
    const playerSongs = player.querySelectorAll(".audio");
    const playButton = player.querySelector(".play");
    const nextButton = player.querySelector(".next");
    const backButton = player.querySelector(".back");
    const playlistButton = player.querySelector(".playlist");
    const slider = player.querySelector(".slider");
    const sliderContext = player.querySelector(".slider__context");
    const sliderName = sliderContext.querySelector(".slider__name");
    const sliderTitle = sliderContext.querySelector(".slider__title");
    const sliderContent = slider.querySelector(".slider__content");
    const sliderContentLength = playerPlayList.length - 1;
    const sliderWidth = 100;
    let left = 0;
    let count = 0;
    let song = playerSongs[count];
    let isPlay = false;
    const pauseIcon = playButton.querySelector("img[alt = 'pause-icon']");
    const playIcon = playButton.querySelector("img[alt = 'play-icon']");
    const progres = player.querySelector(".progres");
    const progresFilled = progres.querySelector(".progres__filled");
    let isMove = false;

    // creat functions
    function openPlayer() {

        playerHeader.classList.add("open-header");
        playerControls.classList.add("move");
        slider.classList.add("open-slider");

    }

    function closePlayer() {

        playerHeader.classList.remove("open-header");
        playerControls.classList.remove("move");
        slider.classList.remove("open-slider");

    }

    function next(index) {

        count = index || count;

        if (count == sliderContentLength) {
            count = count;
            return;
        }

        left = (count + 1) * sliderWidth;
        left = Math.min(left, (sliderContentLength) * sliderWidth);
        sliderContent.style.transform = `translate3d(-${left}%, 0, 0)`;
        count++;
        run();

    }

    function back(index) {

        count = index || count;

        if (count == 0) {
            count = count;
            return;
        }

        left = (count - 1) * sliderWidth;
        left = Math.max(0, left);
        sliderContent.style.transform = `translate3d(-${left}%, 0, 0)`;
        count--;
        run();

    }

    function changeSliderContext() {

        sliderContext.style.animationName = "opacity";

        sliderName.textContent = playerPlayList[count].querySelector(".player__title").textContent;
        sliderTitle.textContent = playerPlayList[count].querySelector(".player__song-name").textContent;

        if (sliderName.textContent.length > 16) {
            const textWrap = document.createElement("span");
            textWrap.className = "text-wrap";
            textWrap.innerHTML = sliderName.textContent + "   " + sliderName.textContent;
            sliderName.innerHTML = "";
            sliderName.append(textWrap);

        }

        if (sliderTitle.textContent.length >= 18) {
            const textWrap = document.createElement("span");
            textWrap.className = "text-wrap";
            textWrap.innerHTML = sliderTitle.textContent + "    " + sliderTitle.textContent;
            sliderTitle.innerHTML = "";
            sliderTitle.append(textWrap);
        }

    }

    function changeBgBody() {
        body.style.backgroundColor = bgBody[count];
    }

    function selectSong() {

        song = playerSongs[count];

        for (const item of playerSongs) {

            if (item != song) {
                item.pause();
                item.currentTime = 0;
            }

        }

        if (isPlay) song.play();


    }

    function run() {

        changeSliderContext();
        changeBgBody();
        selectSong();

    }

    function playSong() {

        if (song.paused) {
            song.play();
            playIcon.style.display = "none";
            pauseIcon.style.display = "block";

        } else {
            song.pause();
            isPlay = false;
            playIcon.style.display = "";
            pauseIcon.style.display = "";
        }


    }

    function progresUpdate() {

        const progresFilledWidth = (this.currentTime / this.duration) * 100 + "%";
        progresFilled.style.width = progresFilledWidth;

        if (isPlay && this.duration == this.currentTime) {
            next();
        }
        if (count == sliderContentLength && song.currentTime == song.duration) {
            playIcon.style.display = "block";
            pauseIcon.style.display = "";
            isPlay = false;
        }
    }

    function scurb(e) {

        // If we use e.offsetX, we have trouble setting the song time, when the mousemove is running
        const currentTime = ((e.clientX - progres.getBoundingClientRect().left) / progres.offsetWidth) * song.duration;
        song.currentTime = currentTime;

    }

    function durationSongs() {

        let min = parseInt(this.duration / 60);
        if (min < 10) min = "0" + min;

        let sec = parseInt(this.duration % 60);
        if (sec < 10) sec = "0" + sec;

        const playerSongTime = `${min}:${sec}`;
        this.closest(".player__song").querySelector(".player__song-time").append(playerSongTime);

    }


    changeSliderContext();

    // add events
    sliderContext.addEventListener("click", openPlayer);
    sliderContext.addEventListener("animationend", () => sliderContext.style.animationName = '');
    playlistButton.addEventListener("click", closePlayer);

    nextButton.addEventListener("click", () => {
        next(0)
    });

    backButton.addEventListener("click", () => {
        back(0)
    });

    playButton.addEventListener("click", () => {
        isPlay = true;
        playSong();
    });

    playerSongs.forEach(song => {
        song.addEventListener("loadeddata", durationSongs);
        song.addEventListener("timeupdate", progresUpdate);

    });

    progres.addEventListener("pointerdown", (e) => {
        scurb(e);
        isMove = true;
    });

    document.addEventListener("pointermove", (e) => {
        if (isMove) {
            scurb(e);
            song.muted = true;
        }
    });

    document.addEventListener("pointerup", () => {
        isMove = false;
        song.muted = false;
    });

    playerPlayList.forEach((item, index) => {

        item.addEventListener("click", function () {

            if (index > count) {
                next(index - 1);
                return;
            }

            if (index < count) {
                back(index + 1);
                return;
            }

        });

    });
</script>

</html>